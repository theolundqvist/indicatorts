"use strict";var $=Object.defineProperty;var Ft=Object.getOwnPropertyDescriptor;var Mt=Object.getOwnPropertyNames;var Pt=Object.prototype.hasOwnProperty;var Ct=(t,e)=>{for(var r in e)$(t,r,{get:e[r],enumerable:!0})},Tt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Mt(e))!Pt.call(t,o)&&o!==r&&$(t,o,{get:()=>e[o],enumerable:!(n=Ft(e,o))||n.enumerable});return t};var Nt=t=>Tt($({},"__esModule",{value:!0}),t);var kr={};Ct(kr,{Action:()=>h,BinarySearchTree:()=>M,CMF_DEFAULT_PERIOD:()=>Ge,CMI_PERIOD:()=>wt,Chart:()=>rt,CompanyResultSortBy:()=>it,DEFAULT_VWMA_PERIOD:()=>X,EMV_DEFAULT_PERIOD:()=>pt,KC_PERIOD:()=>Bt,NVI_DEFAULT_PERIOD:()=>$e,NumRange:()=>B,NumScaler:()=>I,STRATEGY_INFOS:()=>Xt,StrategyStatsSortBy:()=>yt,Trend:()=>j,UI_DEFAULT_PERIOD:()=>vt,VWAP_DEFAULT_PERIOD:()=>ht,abs:()=>v,absolutePriceOscillator:()=>Y,absolutePriceOscillatorStrategy:()=>Yt,accelerationBands:()=>Pe,accelerationBandsStrategy:()=>Ce,accumulationDistribution:()=>nt,add:()=>g,addBy:()=>O,applyActions:()=>ee,aroon:()=>be,aroonStrategy:()=>ge,assetMean:()=>ar,atr:()=>V,awesomeOscillator:()=>re,awesomeOscillatorStrategy:()=>ne,backtest:()=>Gt,balanceOfPower:()=>de,balanceOfPowerStrategy:()=>he,bollingerBands:()=>Ne,bollingerBandsStrategy:()=>ke,bollingerBandsWidth:()=>vr,buyAndHoldStrategy:()=>te,chaikinMoneyFlow:()=>He,chaikinMoneyFlowStrategy:()=>_e,chaikinOscillator:()=>At,chandeForecastOscillator:()=>Ae,chandeForecastOscillatorStrategy:()=>Se,chandelierExit:()=>Rr,changes:()=>F,checkSameLength:()=>d,communityChannelIndex:()=>Ot,computeStrategyStats:()=>zt,concatAssets:()=>Tr,customRsi:()=>_,daysAgo:()=>mr,daysLaterFrom:()=>ir,defaultAbsolutePriceOscillator:()=>fe,defaultAbsolutePriceOscillatorStrategy:()=>pe,defaultChaikinOscillator:()=>sr,defaultCommunityChannelIndex:()=>xr,defaultEaseOfMovement:()=>Ye,defaultForceIndex:()=>je,defaultKdj:()=>Le,defaultKeltnerChannel:()=>Dr,defaultMoneyFlowIndex:()=>Xe,defaultPercentagePriceOscillator:()=>pr,defaultPercentageVolumeOscillator:()=>hr,defaultProjectionOscillator:()=>Ue,defaultUlcerIndex:()=>Fr,defaultVolumeWeightedAveragePrice:()=>Qe,defaultVwma:()=>Br,defaultVwmaStrategy:()=>Nr,dema:()=>yr,divide:()=>s,divideBy:()=>L,donchianChannel:()=>Ir,easeOfMovement:()=>bt,easeOfMovementStrategy:()=>We,ema:()=>f,extractSigns:()=>J,forceIndex:()=>gt,forceIndexStrategy:()=>qe,generateNumbers:()=>T,ichimokuCloud:()=>oe,ichimokuCloudStrategy:()=>me,kdj:()=>ct,kdjStrategy:()=>we,keltnerChannel:()=>Et,leastSquare:()=>st,linearRegressionUsingLeastSquare:()=>xe,macd:()=>Oe,macdStrategy:()=>Be,massIndex:()=>Ar,max:()=>k,mean:()=>z,mmax:()=>y,mmin:()=>S,moneyFlowIndex:()=>dt,moneyFlowIndexStrategy:()=>Ke,movingChandeForecastOscillator:()=>Wt,movingLeastSquare:()=>U,movingLinearRegressionUsingLeastSquare:()=>ye,mstd:()=>Te,msum:()=>A,multiply:()=>x,multiplyBy:()=>l,negativeVolumeIndex:()=>ze,negativeVolumeIndexStrategy:()=>Je,newAssetWithLength:()=>Cr,onBalanceVolume:()=>Mr,parabolicSar:()=>ve,parabolicSarStrategy:()=>Re,percentagePriceOscillator:()=>St,percentageVolumeOscillator:()=>Lt,pow:()=>Q,projectionOscillator:()=>ft,projectionOscillatorStrategy:()=>Ve,qstick:()=>Sr,reverseActions:()=>Vt,rma:()=>H,roundDigits:()=>G,roundDigitsAll:()=>Ut,rsi:()=>_t,rsi2:()=>ie,rsi2Strategy:()=>ue,shiftRightAndFillBy:()=>C,shiftRightBy:()=>R,since:()=>W,sma:()=>b,sortCompanyResults:()=>Ht,sortStrategyStats:()=>Jt,sqrt:()=>Z,stochasticOscillator:()=>ae,stochasticOscillatorStrategy:()=>se,subtract:()=>i,subtractBy:()=>kt,tema:()=>Lr,toISODateString:()=>or,toMonthAndDay:()=>ur,transpose:()=>mt,trima:()=>wr,trix:()=>Or,typicalPrice:()=>P,typicalPriceStrategy:()=>Ie,ulcerIndex:()=>Rt,volumePriceTrend:()=>Pr,volumeWeightedAveragePrice:()=>xt,volumeWeightedAveragePriceStrategy:()=>Ze,vortex:()=>Fe,vortexStrategy:()=>Me,vwma:()=>K,williamsR:()=>ce,williamsRStrategy:()=>le,wvmaStrategy:()=>It});module.exports=Nt(kr);function d(...t){if(t.length>0){let e=t[0].length;for(let r=1;r<t.length;r++)if(t[r].length!==e)throw new Error(`values length at ${r} not ${e}`)}}function z(...t){d(...t);let e=new Array(t[0].length);for(let r=0;r<e.length;r++){let n=0;for(let o=0;o<t.length;o++)n+=t[o][r];e[r]=n/t.length}return e}function v(t){return t.map(e=>Math.abs(e))}function g(t,e){d(t,e);let r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=t[n]+e[n];return r}function O(t,e){let r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]+t;return r}function s(t,e){d(t,e);let r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=t[n]/e[n];return r}function L(t,e){let r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]/t;return r}function x(t,e){d(t,e);let r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=t[n]*e[n];return r}function l(t,e){let r=new Array(e.length);for(let n=0;n<r.length;n++)r[n]=e[n]*t;return r}function i(t,e){d(t,e);let r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=t[n]-e[n];return r}function kt(t,e){let r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]-t;return r}function C(t,e,r){let n=new Array(r.length);for(let o=0;o<n.length;o++)o<t?n[o]=e:n[o]=r[o-t];return n}function R(t,e){return C(t,0,e)}function F(t,e){return i(e,R(t,e))}function J(t){return t.map(e=>e>=0?1:-1)}function mt(...t){d(...t);let e=new Array(t[0].length);for(let r=0;r<e.length;r++){e[r]=new Array(t.length);for(let n=0;n<e[r].length;n++)e[r][n]=t[n][r]}return e}function k(...t){return mt(...t).map(e=>Math.max(...e))}function G(t,e){let r=Math.pow(10,t);return Math.round(e*r)/r}function Ut(t,e){return e.map(r=>G(t,r))}function T(t,e,r){let n=new Array((e-t)/r);for(let o=0;o<n.length;o++)n[o]=t+r*o;return n}function Q(t,e){return t.map(r=>Math.pow(r,e))}function Z(t){return t.map(e=>Math.sqrt(e))}var h=(n=>(n[n.SELL=-1]="SELL",n[n.HOLD=0]="HOLD",n[n.BUY=1]="BUY",n))(h||{});function Vt(t){return t.map(e=>e===1?-1:e===-1?1:0)}function ee(t,e){d(t,e);let r=new Array(t.length),n=1,o=n,m=0;for(let a=0;a<r.length;a++)e[a]===1?o>0&&(m=o/t[a],o=0):e[a]===-1&&m>0&&(o=m*t[a],m=0),r[a]=(m*t[a]+o-n)/n;return r}function Gt(t,e){let r=new Array(e.length);for(let n=0;n<r.length;n++){let o=e[n].strategy(t),m=ee(t.closings,o);r[n]={info:e[n],gains:m,gain:m[m.length-1],lastAction:o[o.length-1]}}return r.sort((n,o)=>o.gain-n.gain),r}var it=(m=>(m[m.SYMBOL=0]="SYMBOL",m[m.NAME=1]="NAME",m[m.STRATEGY=2]="STRATEGY",m[m.GAIN=3]="GAIN",m[m.ACTION=4]="ACTION",m))(it||{});function Ht(t,e,r){let n=[];switch(e){case 0:n=t.sort((o,m)=>o.companyInfo.symbol.localeCompare(m.companyInfo.symbol));break;case 1:n=t.sort((o,m)=>o.companyInfo.name.localeCompare(m.companyInfo.name));break;case 2:n=t.sort((o,m)=>o.strategyResults[0].info.name.localeCompare(m.strategyResults[0].info.name));break;case 3:n=t.sort((o,m)=>o.strategyResults[0].gain-m.strategyResults[0].gain);break;case 4:n=t.sort((o,m)=>o.strategyResults[0].lastAction-m.strategyResults[0].lastAction);break}return r||(n=n.reverse()),n}function te(t){return Array(t.closings.length).fill(1)}function b(t,e){let r=new Array(e.length),n=0;for(let o=0;o<e.length;o++)n+=e[o],o>=t?(n-=e[o-t],r[o]=n/t):r[o]=n/(o+1);return r}function re(t,e){let r=L(2,g(e,t)),n=b(5,r),o=b(34,r);return i(n,o)}function ne(t){return re(t.highs,t.lows).map(r=>r>0?1:r<0?-1:0)}var M=class t{constructor(){this.root=null}insert(e){let r={value:e,left:null,right:null};if(this.root===null){this.root=r;return}let n=this.root,o=!1;for(;!o;)r.value<=n.value?n.left===null?(n.left=r,o=!0):n=n.left:n.right===null?(n.right=r,o=!0):n=n.right}remove(e){let r={node:this.root,parent:null};for(;r.node!==null;){if(e===r.node.value)return this.removeNode(r),!0;r.parent=r.node,e<r.node.value?r.node=r.node.left:r.node=r.node.right}return!1}min(){let e=t.minNode(this.root);if(e.node===null)throw new Error("Tree empty");return e.node.value}max(){let e=t.maxNode(this.root);if(e.node===null)throw new Error("Tree empty");return e.node?.value}removeNode(e){if(e.node!==null)if(e.node.left!==null&&e.node.right!==null){let r=t.minNode(e.node.right);r.parent===null&&(r.parent=e.node),this.removeNode(r),r.node!==null&&(e.node.value=r.node.value)}else{let r=null;e.node.left!==null?r=e.node.left:r=e.node.right,e.parent===null?this.root=r:e.parent.left===e.node?e.parent.left=r:e.parent.right=r}}static minNode(e){let r={node:null,parent:null};if(e!==null)for(r.node=e;r.node.left!==null;)r.parent=r.node,r.node=r.node.left;return r}static maxNode(e){let r={node:null,parent:null};if(e!==null)for(r.node=e;r.node.right!==null;)r.parent=r.node,r.node=r.node.right;return r}};function y(t,e){let r=new Array(e.length),n=new M;for(let o=0;o<e.length;o++)n.insert(e[o]),o>=t&&n.remove(e[o-t]),r[o]=n.max();return r}function S(t,e){let r=new Array(e.length),n=new M;for(let o=0;o<e.length;o++)n.insert(e[o]),o>=t&&n.remove(e[o-t]),r[o]=n.min();return r}function oe(t,e,r){d(t,e,r);let n=L(2,g(y(9,t),S(9,e))),o=L(2,g(y(26,t),S(26,e))),m=L(2,g(n,o)),a=L(2,g(y(52,t),S(52,e))),u=R(26,r);return{conversionLine:n,baseLine:o,leadingSpanA:m,leadingSpanB:a,laggingSpan:u}}function me(t){let e=oe(t.highs,t.lows,t.closings),r=new Array(e.baseLine.length);for(let n=0;n<r.length;n++)e.leadingSpanA[n]>e.leadingSpanB[n]?r[n]=1:e.leadingSpanA[n]<e.leadingSpanB[n]?r[n]=-1:r[n]=0;return r}function H(t,e){let r=new Array(e.length),n=0;for(let o=0;o<e.length;o++){let m=o+1;o<t?n+=e[o]:(n=r[o-1]*(t-1)+e[o],m=t),r[o]=n/m}return r}function _(t,e){let r=new Array(e.length),n=new Array(e.length);r[0]=n[0]=0;for(let p=1;p<e.length;p++){let c=e[p]-e[p-1];c>0?(r[p]=c,n[p]=0):(n[p]=-c,r[p]=0)}let o=H(t,r),m=H(t,n),a=new Array(e.length),u=new Array(e.length);a[0]=u[0]=0;for(let p=1;p<e.length;p++)u[p]=o[p]/m[p],a[p]=100-100/(1+u[p]);return a}function _t(t){return _(14,t)}function ie(t){return _(2,t)}function ue(t){let e=ie(t.closings),r=new Array(e.length);for(let n=0;n<r.length;n++)e[n]<10?r[n]=1:e[n]>90?r[n]=-1:r[n]=0;return r}function ae(t,e,r){let n=y(14,t),o=S(14,e),m=l(100,s(i(r,o),i(n,o))),a=b(3,m);return{k:m,d:a}}function se(t){let e=ae(t.highs,t.lows,t.closings),r=new Array(e.k.length);for(let n=0;n<r.length;n++)e.k[n]>=80&&e.d[n]>=80?r[n]=-1:e.k[n]<=20&&e.d[n]<=20?r[n]=1:r[n]=0;return r}var ut=14;function ce(t,e,r){let n=y(ut,t),o=S(ut,e);return l(-100,s(i(n,r),i(n,o)))}function le(t){return ce(t.highs,t.lows,t.closings).map(r=>r<=-80?1:r>=-20?-1:0)}function f(t,e){let r=new Array(e.length);if(r.length>0){let n=2/(1+t),o=1-n;r[0]=e[0];for(let m=1;m<r.length;m++)r[m]=e[m]*n+r[m-1]*o}return r}function Y(t,e,r){let n=f(t,r),o=f(e,r);return i(n,o)}function fe(t){return Y(14,30,t)}function at(t){let e=new Array(t.length);for(let r=0;r<e.length;r++)t[r]>0?e[r]=1:t[r]<0?e[r]=-1:e[r]=0;return e}function Yt(t,e,r){return at(Y(t,e,r.closings))}function pe(t){return at(fe(t.closings))}function W(t){let e=new Array(t.length);if(t.length>0){let r=null,n=0;for(let o=0;o<t.length;o++)r!==t[o]?(r=t[o],n=0):n++,e[o]=n}return e}var N=25;function be(t,e){d(t,e);let r=W(y(N,t)),n=W(S(N,e)),o=l(100,L(N,O(N,l(-1,r)))),m=l(100,L(N,O(N,l(-1,n))));return{up:o,down:m}}function ge(t){let e=be(t.highs,t.lows),r=new Array(e.up.length);for(let n=0;n<r.length;n++)e.up[n]>e.down[n]?r[n]=1:e.down[n]>e.up[n]?r[n]=-1:r[n]=0;return r}function de(t,e,r,n){return s(i(n,t),i(e,r))}function he(t){return de(t.openings,t.highs,t.lows,t.closings).map(r=>r>0?1:r<0?-1:0)}function st(t,e){d(t,e);let r=0,n=0,o=0,m=0;for(let c=0;c<t.length;c++)r+=t[c],n+=t[c]*t[c],o+=e[c],m+=t[c]*e[c];let a=t.length,u=(a*m-r*o)/(a*n-r*r),p=(o-u*r)/a;return{m:u,b:p}}function U(t,e,r){d(e,r);let n=new Array(e.length),o=new Array(e.length),m=0,a=0,u=0,p=0;for(let c=0;c<e.length;c++){m+=e[c],a+=e[c]*e[c],u+=r[c],p+=e[c]*r[c];let w=c+1;c>=t&&(m-=e[c-t],a-=e[c-t]*e[c-t],u-=r[c-t],p-=e[c-t]*r[c-t],w=t),c>0?(n[c]=(w*p-m*u)/(w*a-m*m),o[c]=(u-n[c]*m)/w):(n[c]=0,o[c]=0)}return{m:n,b:o}}function xe(t,e){let r=st(t,e);return O(r.b,l(r.m,t))}function ye(t,e,r){let n=U(t,e,r);return g(x(n.m,e),n.b)}function Ae(t){let e=T(0,t.length,1),r=xe(e,t);return l(100,s(i(t,r),t))}function Wt(t,e){let r=T(0,e.length,1),n=ye(t,r,e);return l(100,s(i(e,n),e))}function Se(t){return Ae(t.closings).map(r=>r>0?1:r<0?-1:0)}function ct(t,e,r,n,o,m){let a=y(t,n),u=S(t,o),p=l(100,s(i(m,u),i(a,u))),c=b(e,p),w=b(r,c),D=i(l(3,c),l(2,w));return{k:c,d:w,j:D}}function Le(t,e,r){return ct(9,3,3,t,e,r)}function we(t){let e=Le(t.highs,t.lows,t.closings),r=new Array(e.k.length);for(let n=0;n<r.length;n++)e.k[n]>e.d[n]&&e.k[n]<=20?r[n]=1:e.k[n]<e.d[n]&&e.k[n]>=80?r[n]=-1:r[n]=0;return r}function Oe(t){let e=f(12,t),r=f(26,t),n=i(e,r),o=f(9,n);return{macdLine:n,signalLine:o}}function Be(t){let e=Oe(t.closings),r=new Array(e.macdLine.length);for(let n=0;n<r.length;n++)e.macdLine[n]>e.signalLine[n]?r[n]=1:e.macdLine[n]<e.signalLine[n]?r[n]=-1:r[n]=0;return r}var j=(n=>(n[n.FALLING=-1]="FALLING",n[n.STABLE=0]="STABLE",n[n.RISING=1]="RISING",n))(j||{});var Ee=.02,jt=.2;function ve(t,e,r){d(t,e,r);let n=new Array(t.length),o=new Array(t.length);n[0]=-1,o[0]=t[0];let m=Ee,a=e[0];for(let u=1;u<o.length;u++){o[u]=o[u-1]-(o[u-1]-a)*m,n[u-1]===-1?(o[u]=Math.max(o[u],t[u-1]),u>1&&(o[u]=Math.max(o[u],t[u-2])),t[u]>=o[u]&&(o[u]=a)):(o[u]=Math.min(o[u],e[u-1]),u>1&&(o[u]=Math.min(o[u],e[u-2])),e[u]<=o[u]&&(o[u]=a));let p=a;o[u]>r[u]?(n[u]=-1,a=Math.min(a,e[u])):(n[u]=1,a=Math.max(a,t[u])),n[u]!==n[u-1]?m=Ee:p!==a&&m<jt&&(m+=Ee)}return{trends:n,psar:o}}function Re(t){return ve(t.highs,t.lows,t.closings).trends.map(r=>{switch(r){case-1:return-1;case 1:return 1;case 0:return 0}})}function P(t,e,r){return L(3,g(g(t,e),r))}function Ie(t){let e=P(t.highs,t.lows,t.closings),r=new Array(e.length);r[0]=0;for(let n=1;n<r.length;n++)e[n]>e[n-1]?r[n]=1:e[n]<e[n-1]?r[n]=-1:r[n]=0;return r}function A(t,e){let r=new Array(e.length),n=0;for(let o=0;o<e.length;o++)n+=e[o],o>=t&&(n-=e[o-t]),r[o]=n;return r}var De=14;function Fe(t,e,r){d(t,e,r);let n=R(1,r),o=v(i(t,R(1,e))),m=v(i(e,R(1,t))),a=A(De,o),u=A(De,m),p=k(i(t,e),v(i(t,n)),v(i(e,n))),c=A(De,p),w=s(a,c),D=s(u,c);return{plusVi:w,minusVi:D}}function Me(t){let e=Fe(t.highs,t.lows,t.closings),r=new Array(e.plusVi.length);for(let n=0;n<r.length;n++)e.plusVi[n]>e.minusVi[n]?r[n]=1:e.plusVi[n]<e.minusVi[n]?r[n]=-1:r[n]=0;return r}function Pe(t,e,r){d(t,e,r);let n=s(i(t,e),g(t,e)),o=b(20,x(t,O(1,l(4,n)))),m=b(20,r),a=b(20,x(e,O(1,l(-4,n))));return{upperBand:o,middleBand:m,lowerBand:a}}function Ce(t){let e=Pe(t.highs,t.lows,t.closings),r=new Array(e.upperBand.length);for(let n=0;n<r.length;n++)t.closings[n]>=e.upperBand[n]?r[n]=1:r[n]=-1;return r}function Te(t,e){let r=new Array(e.length),n=b(t,e);for(let o=0;o<e.length;o++)if(r[o]=0,o>=t-1){let m=0;for(let a=o-(t-1);a<=o;a++)m+=(e[a]-n[o])*(e[a]-n[o]);r[o]=Math.sqrt(m/t)}return r}var lt=20;function Ne(t){let e=l(2,Te(lt,t)),r=b(lt,t),n=g(r,e),o=i(r,e);return{upperBand:n,middleBand:r,lowerBand:o}}function ke(t){let e=Ne(t.closings),r=new Array(e.upperBand.length);for(let n=0;n<r.length;n++)t.closings[n]>e.upperBand[n]?r[n]=-1:t.closings[n]<e.lowerBand[n]?r[n]=1:r[n]=0;return r}function ft(t,e,r,n,o){let m=T(0,o.length,1),a=U(t,m,r),u=U(t,m,n),p=g(r,x(a.m,m)),c=g(n,x(u.m,m)),w=y(t,p),D=S(t,c),E=s(l(100,i(o,D)),i(w,D)),Dt=f(e,E);return{po:E,spo:Dt}}function Ue(t,e,r){return ft(14,3,t,e,r)}function Ve(t){let e=Ue(t.highs,t.lows,t.closings),r=new Array(e.po.length);for(let n=0;n<r.length;n++)e.po[n]>e.spo[n]?r[n]=1:e.po[n]<e.spo[n]?r[n]=-1:r[n]=0;return r}var Ge=20;function He(t,e,r,n){let o=s(i(i(r,e),i(t,r)),i(t,e)),m=x(o,n);return s(A(Ge,m),A(Ge,n))}function _e(t){return He(t.highs,t.lows,t.closings,t.volumes).map(r=>r<0?1:r>0?-1:0)}var pt=14;function bt(t,e,r,n){let o=F(1,L(2,g(e,r))),m=s(L(1e8,n),i(e,r));return b(t,s(o,m))}function Ye(t,e,r){return bt(pt,t,e,r)}function We(t){return Ye(t.highs,t.lows,t.volumes).map(r=>r>0?1:r<0?-1:0)}function gt(t,e,r){return f(t,x(F(1,e),r))}function je(t,e){return gt(13,t,e)}function qe(t){return je(t.closings,t.volumes).map(r=>r>0?1:r<0?-1:0)}function dt(t,e,r,n,o){let m=x(P(e,r,n),o),a=J(F(1,m)),u=x(a,m),p=u.map(E=>E>=0?E:0),c=u.map(E=>E<0?E:0),w=s(A(t,p),A(t,l(-1,c)));return O(100,l(-100,Q(O(1,w),-1)))}function Xe(t,e,r,n){return dt(14,t,e,r,n)}function Ke(t){return Xe(t.highs,t.lows,t.closings,t.volumes).map(r=>r>=80?-1:1)}var qt=1e3,$e=255;function ze(t,e){d(t,e);let r=new Array(t.length);for(let n=0;n<r.length;n++)n===0?r[n]=qt:e[n-1]<e[n]?r[n]=r[n-1]:r[n]=r[n-1]+(t[n]-t[n-1])/t[n-1]*r[n-1];return r}function Je(t){let e=ze(t.closings,t.volumes),r=f($e,e),n=new Array(e.length);for(let o=0;o<n.length;o++)e[o]<r[o]?n[o]=1:e[o]>r[o]?n[o]=-1:n[o]=0;return n}var ht=14;function xt(t,e,r){return s(A(t,x(e,r)),A(t,r))}function Qe(t,e){return xt(ht,t,e)}function Ze(t){let e=Qe(t.closings,t.volumes);return i(e,t.closings).map(n=>n>0?1:n<0?-1:0)}var Xt=[{name:"Buy Hold",strategy:te},{name:"Awesome Oscillator",strategy:ne},{name:"RSI 2",strategy:ue},{name:"Ichimoku Cloud",strategy:me},{name:"Stochastic Oscillator",strategy:se},{name:"Williams R",strategy:le},{name:"Absolute Price Oscillator (APO)",strategy:pe},{name:"Aroon Strategy",strategy:ge},{name:"Balance of Power (BOM)",strategy:he},{name:"Chande Forecast Oscillator (CFO)",strategy:Se},{name:"KDJ Strategy",strategy:we},{name:"MACD Strategy",strategy:Be},{name:"Parabolic SAR",strategy:Re},{name:"Typical Price",strategy:Ie},{name:"Vortex Strategy",strategy:Me},{name:"Acceleration Bands",strategy:Ce},{name:"Bollinger Bands",strategy:ke},{name:"Projection Oscillator",strategy:Ve},{name:"Chaikin Money Flow (CMF)",strategy:_e},{name:"Ease of Movement (EMV)",strategy:We},{name:"Force Index",strategy:qe},{name:"Money Flow Index",strategy:Ke},{name:"Negative Volume Index (NVI)",strategy:Je},{name:"Volume Weighted Average Price",strategy:Ze}];function Kt(t){return{strategyInfo:t.info,score:1,minGain:t.gain,maxGain:t.gain,averageGain:t.gain}}function $t(t,e){t.score++,t.minGain=Math.min(t.minGain,e.gain),t.maxGain=Math.max(t.maxGain,e.gain),t.averageGain=(t.averageGain+e.gain)/2}function zt(t){let e=new Map;for(let n of t){let o=n.strategyResults[0],m=e.get(o.info.name);m!==void 0?$t(m,o):e.set(o.info.name,Kt(o))}let r=Array.from(e.values());return r.sort((n,o)=>o.score-n.score),r}var yt=(m=>(m[m.STRATEGY=0]="STRATEGY",m[m.SCORE=1]="SCORE",m[m.MIN=2]="MIN",m[m.MAX=3]="MAX",m[m.AVERAGE=4]="AVERAGE",m))(yt||{});function Jt(t,e,r){let n=[];switch(e){case 0:n=t.sort((o,m)=>o.strategyInfo.name.localeCompare(m.strategyInfo.name));break;case 1:n=t.sort((o,m)=>o.score-m.score);break;case 2:n=t.sort((o,m)=>o.minGain-m.minGain);break;case 3:n=t.sort((o,m)=>o.maxGain-m.maxGain);break;case 4:n=t.sort((o,m)=>o.averageGain-m.averageGain);break}return r||(n=n.reverse()),n}var B=class t{constructor(e,r){this.min=e,this.max=r}getMin(){return this.min}getMax(){return this.max}span(){return this.max-this.min}static merge(e){return e.reduce((r,n)=>new t(Math.min(r.min,n.min),Math.max(r.max,n.max)))}static from(e){return new t(Math.min(...e),Math.max(...e))}};var I=class{constructor(e,r){this.fromDelta=e.getMin(),this.toDelta=r.getMin(),this.multiplier=r.span()/e.span()}scale(e){return(e-this.fromDelta)*this.multiplier+this.toDelta}descale(e){return(e-this.toDelta)/this.multiplier+this.fromDelta}};var Qt="black",Zt=1,er="red",tr=1,rr=30,et=4,nr="14px Arial",tt=-1,q=new B(0,1),rt=class{constructor(e){let r=document.getElementById(e);if(r===null)throw new Error("Canvas element not found");if(!(r instanceof HTMLCanvasElement))throw new Error("Not a canvas element");this.canvas=r;let n=this.canvas.getContext("2d");if(n===null)throw new Error("Canvas context is null");this.context=n,this.dataSets=new Map,this.dateSetsChanged=!1,this.xScaler=new I(q,q),this.yScaler=new I(q,q),this.xFocus=tt,this.canvas.addEventListener("mousemove",o=>this.onMouseMove(o)),this.canvas.addEventListener("mouseout",()=>this.onMouseOut())}add(e){this.dataSets.set(e.legend,e),this.dateSetsChanged=!0}remove(e){let r=this.dataSets.delete(e);return r&&(this.dateSetsChanged=!0),r}draw(){this.dateSetsChanged&&(this.updateScalers(),this.dateSetsChanged=!1),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawDataSets(),this.drawFocus()}drawDataSets(){let e=this.chartHeight();for(let r of this.dataSets.values()){this.context.lineWidth=r.width??Zt;let n=0,o=0;for(let m=0;m<r.values.length;m++){let a=this.xScaler.scale(m),u=e-this.yScaler.scale(r.values[m]);m>0&&(this.context.strokeStyle=this.styleAtIndex(r,m),this.context.beginPath(),this.context.moveTo(n,o),this.context.lineTo(a,u),this.context.stroke()),n=a,o=u}}}styleAtIndex(e,r){return e.style===void 0?Qt:Array.isArray(e.style)?e.style[r]:e.style}drawFocus(){this.xFocus!==tt&&(this.drawFocusLine(),this.drawFocusedValues())}drawFocusLine(){this.context.strokeStyle=er,this.context.lineWidth=tr,this.context.beginPath(),this.context.moveTo(this.xFocus,0),this.context.lineTo(this.xFocus,this.chartHeight()),this.context.stroke()}drawFocusedValues(){let e=Math.round(this.xScaler.descale(this.xFocus)),r=et;this.context.font=nr,this.context.textBaseline="bottom";for(let n of this.dataSets.values())if(e>=0&&e<n.values.length){let o=n.legend+" "+G(2,n.values[e]).toString();this.context.fillStyle=this.styleAtIndex(n,e),this.context.fillText(o,r,this.canvas.height-et),r+=this.context.measureText(o).width+et}}chartHeight(){return this.canvas.height-rr}updateScalers(){this.dataSets.size!==0&&(this.xScaler=new I(new B(0,Math.max(...Array.from(this.dataSets.values(),e=>e.values.length))),new B(0,this.canvas.width)),this.yScaler=new I(B.merge(Array.from(this.dataSets.values(),e=>B.from(e.values))),new B(0,this.chartHeight())))}onMouseMove(e){let r=this.canvas.getBoundingClientRect();this.xFocus=e.clientX-r.left,this.draw()}onMouseOut(){this.xFocus=tt,this.draw()}};function or(t){return t.toISOString().substring(0,10)}function mr(t){let e=new Date;return e.setDate(e.getDate()-t),e}function ir(t,e){let r=new Date(t);return r.setDate(r.getDate()+e),r}function ur(t){return(t.getMonth()+1).toString()+"/"+t.getDate().toString()}function ar(t){return z(t.highs,t.lows)}function nt(t,e,r,n){let o=s(i(i(r,e),i(t,r)),i(t,e)),m=x(o,n),a=new Array(m.length);for(let u=0;u<a.length;u++)a[u]=m[u],u>0&&(a[u]+=a[u-1]);return a}function At(t,e,r,n,o,m){let a=nt(r,n,o,m),u=i(f(t,a),f(e,a));return{ad:a,co:u}}function sr(t,e,r,n){return At(3,10,t,e,r,n)}var cr=12,lr=26,fr=9;function St(t,e,r,n){let o=f(t,n),m=f(e,n),a=l(100,s(i(o,m),m)),u=f(r,a),p=i(a,u);return{ppo:a,signal:u,histogram:p}}function pr(t){return St(cr,lr,fr,t)}var br=12,gr=26,dr=9;function Lt(t,e,r,n){let o=f(t,n),m=f(e,n),a=l(100,s(i(o,m),m)),u=f(r,a),p=i(a,u);return{pvo:a,signal:u,histogram:p}}function hr(t){return Lt(br,gr,dr,t)}var wt=20;function Ot(t,e,r,n){let o=P(e,r,n),m=b(t,o),a=b(t,v(i(o,m)));return s(i(o,m),l(.015,a))}function xr(t,e,r){return Ot(wt,t,e,r)}function yr(t,e){let r=f(t,e),n=f(t,r);return i(l(2,r),n)}function Ar(t,e){let r=f(9,i(t,e)),n=f(9,r),o=s(r,n);return A(25,o)}function Sr(t,e,r){return b(t,i(r,e))}function Lr(t,e){let r=f(t,e),n=f(t,r),o=f(t,n);return g(i(l(3,r),l(3,n)),o)}function wr(t,e){let r=0,n=0;return t%2===0?(r=t/2,n=r+1):(r=(t+1)/2,n=r),b(r,b(n,e))}function Or(t,e){let r=f(t,e),n=f(t,r),o=f(t,n),m=C(1,o[0],o);return s(i(o,m),m)}var X=20;function K(t,e,r){return s(A(t,x(e,r)),A(t,r))}function Br(t,e){return K(X,t,e)}function V(t,e,r,n){d(e,r,n);let o=k(i(e,r),i(e,n),i(n,r)),m=b(t,o);return{trLine:o,atrLine:m}}var Er=90;function vr(t){let e=s(i(t.upperBand,t.lowerBand),t.middleBand),r=f(Er,e);return{bandWidth:e,bandWidthEma90:r}}var ot=22;function Rr(t,e,r){let n=V(ot,t,e,r),o=l(3,n.atrLine),m=y(ot,t),a=S(ot,e),u=i(m,o),p=g(a,o);return{exitLong:u,exitShort:p}}function Ir(t,e){let r=y(t,e),n=S(t,e),o=L(2,g(r,n));return{upperChannel:r,middleChannel:o,lowerChannel:n}}var Bt=20;function Et(t,e,r,n){let o=V(t,e,r,n),m=l(2,o.atrLine),a=f(t,n),u=g(a,m),p=i(a,m);return{middleLine:a,upperBand:u,lowerBand:p}}function Dr(t,e,r){return Et(Bt,t,e,r)}var vt=14;function Rt(t,e){let r=y(t,e),n=l(100,s(i(e,r),r)),o=b(t,x(n,n));return Z(o)}function Fr(t){return Rt(vt,t)}function Mr(t,e){d(t,e);let r=new Array(t.length);for(let n=1;n<r.length;n++)n===0?r[n]=0:(r[n]=r[n-1],t[n]>t[n-1]?r[n]+=e[n]:t[n]<t[n-1]&&(r[n]-=e[n]));return r}function Pr(t,e){let r=C(1,t[0],t),n=x(e,s(i(t,r),r));return A(n.length,n)}function Cr(t){return{dates:new Array(t),openings:new Array(t),closings:new Array(t),highs:new Array(t),lows:new Array(t),volumes:new Array(t)}}function Tr(t,e){return{dates:[...t.dates,...e.dates],openings:[...t.openings,...e.openings],closings:[...t.closings,...e.closings],highs:[...t.highs,...e.highs],lows:[...t.lows,...e.lows],volumes:[...t.volumes,...e.volumes]}}function It(t,e){let r=b(t,e.closings),n=K(t,e.closings,e.volumes),o=new Array(n.length);for(let m=0;m<o.length;m++)n[m]>r[m]?o[m]=1:n[m]<r[m]?o[m]=-1:o[m]=0;return o}function Nr(t){return It(X,t)}0&&(module.exports={Action,BinarySearchTree,CMF_DEFAULT_PERIOD,CMI_PERIOD,Chart,CompanyResultSortBy,DEFAULT_VWMA_PERIOD,EMV_DEFAULT_PERIOD,KC_PERIOD,NVI_DEFAULT_PERIOD,NumRange,NumScaler,STRATEGY_INFOS,StrategyStatsSortBy,Trend,UI_DEFAULT_PERIOD,VWAP_DEFAULT_PERIOD,abs,absolutePriceOscillator,absolutePriceOscillatorStrategy,accelerationBands,accelerationBandsStrategy,accumulationDistribution,add,addBy,applyActions,aroon,aroonStrategy,assetMean,atr,awesomeOscillator,awesomeOscillatorStrategy,backtest,balanceOfPower,balanceOfPowerStrategy,bollingerBands,bollingerBandsStrategy,bollingerBandsWidth,buyAndHoldStrategy,chaikinMoneyFlow,chaikinMoneyFlowStrategy,chaikinOscillator,chandeForecastOscillator,chandeForecastOscillatorStrategy,chandelierExit,changes,checkSameLength,communityChannelIndex,computeStrategyStats,concatAssets,customRsi,daysAgo,daysLaterFrom,defaultAbsolutePriceOscillator,defaultAbsolutePriceOscillatorStrategy,defaultChaikinOscillator,defaultCommunityChannelIndex,defaultEaseOfMovement,defaultForceIndex,defaultKdj,defaultKeltnerChannel,defaultMoneyFlowIndex,defaultPercentagePriceOscillator,defaultPercentageVolumeOscillator,defaultProjectionOscillator,defaultUlcerIndex,defaultVolumeWeightedAveragePrice,defaultVwma,defaultVwmaStrategy,dema,divide,divideBy,donchianChannel,easeOfMovement,easeOfMovementStrategy,ema,extractSigns,forceIndex,forceIndexStrategy,generateNumbers,ichimokuCloud,ichimokuCloudStrategy,kdj,kdjStrategy,keltnerChannel,leastSquare,linearRegressionUsingLeastSquare,macd,macdStrategy,massIndex,max,mean,mmax,mmin,moneyFlowIndex,moneyFlowIndexStrategy,movingChandeForecastOscillator,movingLeastSquare,movingLinearRegressionUsingLeastSquare,mstd,msum,multiply,multiplyBy,negativeVolumeIndex,negativeVolumeIndexStrategy,newAssetWithLength,onBalanceVolume,parabolicSar,parabolicSarStrategy,percentagePriceOscillator,percentageVolumeOscillator,pow,projectionOscillator,projectionOscillatorStrategy,qstick,reverseActions,rma,roundDigits,roundDigitsAll,rsi,rsi2,rsi2Strategy,shiftRightAndFillBy,shiftRightBy,since,sma,sortCompanyResults,sortStrategyStats,sqrt,stochasticOscillator,stochasticOscillatorStrategy,subtract,subtractBy,tema,toISODateString,toMonthAndDay,transpose,trima,trix,typicalPrice,typicalPriceStrategy,ulcerIndex,volumePriceTrend,volumeWeightedAveragePrice,volumeWeightedAveragePriceStrategy,vortex,vortexStrategy,vwma,williamsR,williamsRStrategy,wvmaStrategy});
//# sourceMappingURL=index.js.map
